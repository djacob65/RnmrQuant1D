<!DOCTYPE html><html><head><title>R: RnmrQuant1D</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table style="width: 100%;"><tr><td>RnmrQuant1D</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='RnmrQuant1D'>RnmrQuant1D</h2>

<h3>Description</h3>

<p>Package dedicated to quantification from 1D NMR spectra, including peak fitting and calibration using standard spectra.
</p>


<h3>Details</h3>

<p>This package was initially developed as part of an ANR project on wine authenticity (<a href="https://anr.fr/Project-ANR-21-CE21-0014">ANR-21-CE21-0014</a>). However, it is generic enough to be used on other biological and/or food matrices. This involves the implementation of an analytical protocol allowing quantification from an external standard (see references).<br /><br />
This package provides all the methods needed: <br /> 
</p>

<ol>
<li><p> to calculate different entities such as i) integration of patterns related to the targeted compounds of interest, ii) signal-to-noise ratio of motifs, iii) absolute quantifications of the targeted compounds,
</p>
</li>
<li><p> to calculate PULCON factors and verify using a quality control sample,
</p>
</li>
<li><p>  to exploit the results i) by producing a complete workbook gathering all the calculated data but also information needed for tracing, ii) by visualizing the spectra zones related to each targeted compound including the result of the deconvolution and the identification of patterns.
</p>
</li></ol>

<p><br />
To work, this package needs a number of input files:<br />
</p>

<ol>
<li><p> a set of spectra concerning the samples. There may be for the same sample several repetitions acquired according to one or more sequences (zgpr, noesy)
</p>
</li>
<li><p> a set of spectra concerning quality control (QC) and quantification standards (QS). Similarly, there may be several repetitions acquired according to one or more sequences (zgpr, noesy)
</p>
</li>
<li><p> a file describing the samples by linking them to spectral data
</p>
</li>
<li><p> a file describing the QC and the QS samples in terms of compounds and their concentration, called &quot;calibration profile&quot;
</p>
</li>
<li><p> a file containing the parameters for deconvolution and quantification, zone by zone, called &quot;quantification profile&quot;
</p>
</li></ol>

<p><br />
The user can refer to the <a href="https://github.com/djacob65/RnmrQuant1D/wiki/">online tutorial</a> for more details on the structure of the input files, and on the different steps to perform the quantifications, from data preparation to final results.<br />
<br /> 
It was implemented based on the object-oriented programming using the R6 class.
</p>


<h3>Super class</h3>

<p><code>RnmrQuant1D::internalClass</code> -&gt; <code>RnmrQuant1D</code>
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>RAWDIR</code></dt><dd><p>Path of the sample spectra directory (required)</p>
</dd>
<dt><code>QSDIR</code></dt><dd><p>Path of the QC-QS spectra directory (required)</p>
</dd>
<dt><code>TMPDIR</code></dt><dd><p>Output path for logs (required)</p>
</dd>
<dt><code>RDATADIR</code></dt><dd><p>Output path for RData files (required)</p>
</dd>
<dt><code>SAMPLES</code></dt><dd><p>The sample table (required)</p>
</dd>
<dt><code>PROFILE</code></dt><dd><p>The quantification profile obtained by the <a href="#method-RnmrQuant1D-readProfile"><code>readProfile()</code></a> method (required).</p>
</dd>
<dt><code>CALIBRATION</code></dt><dd><p>The calibration profile as a data.frame (required)</p>
</dd>
<dt><code>SEQUENCE</code></dt><dd><p>The instrument sequence (required)</p>
</dd>
<dt><code>FIELD</code></dt><dd><p>The instrument Field (recommended for tracing)</p>
</dd>
<dt><code>TYPE</code></dt><dd><p>The sample type (recommended for tracing)</p>
</dd>
<dt><code>OUTTYPE</code></dt><dd><p>specifies the output type for plotly graphs and data tables. The value can be &quot;html&quot;, &quot;png&quot;, &quot;jpeg&quot;, or &quot;svg&quot; (default = &quot;html&quot;)</p>
</dd>
<dt><code>FDILfield</code></dt><dd><p>Name of the dilution factor column in the sample table (default = &quot;F_dilution&quot;)</p>
</dd>
<dt><code>QCtype</code></dt><dd><p>Identifier of the Quality Control (QC) in the calibration profile (1st column - default = &quot;QC&quot;)</p>
</dd>
<dt><code>QStype</code></dt><dd><p>Identifier of the Quantification Standards (QS) in the calibration profile (1st column - default = &quot;QS&quot;)</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-RnmrQuant1D-new"><code>RnmrQuant1D$new()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-check_samples"><code>RnmrQuant1D$check_samples()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-check_calibration"><code>RnmrQuant1D$check_calibration()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-check_profile"><code>RnmrQuant1D$check_profile()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-check_outdir"><code>RnmrQuant1D$check_outdir()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-check_all"><code>RnmrQuant1D$check_all()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-get_samples_table"><code>RnmrQuant1D$get_samples_table()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-readProfile"><code>RnmrQuant1D$readProfile()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-get_response_factors"><code>RnmrQuant1D$get_response_factors()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-get_factor_table"><code>RnmrQuant1D$get_factor_table()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-get_QC_estimation"><code>RnmrQuant1D$get_QC_estimation()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-plot_QC_estimation"><code>RnmrQuant1D$plot_QC_estimation()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-proc_Integrals"><code>RnmrQuant1D$proc_Integrals()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-get_Matrix_Integrals"><code>RnmrQuant1D$get_Matrix_Integrals()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-get_Matrix_SNR"><code>RnmrQuant1D$get_Matrix_SNR()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-get_Matrix_CV"><code>RnmrQuant1D$get_Matrix_CV()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-save_Matrices"><code>RnmrQuant1D$save_Matrices()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-view_spectra"><code>RnmrQuant1D$view_spectra()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-proc_fPULCON"><code>RnmrQuant1D$proc_fPULCON()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-proc_Quantification"><code>RnmrQuant1D$proc_Quantification()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-get_output_results"><code>RnmrQuant1D$get_output_results()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-get_spectra_data"><code>RnmrQuant1D$get_spectra_data()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-save_Results"><code>RnmrQuant1D$save_Results()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-plot_spectra"><code>RnmrQuant1D$plot_spectra()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-displayWidget"><code>RnmrQuant1D$displayWidget()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-saveWidgetFix"><code>RnmrQuant1D$saveWidgetFix()</code></a>
</p>
</li>
<li> <p><a href="#method-RnmrQuant1D-displayTable"><code>RnmrQuant1D$displayTable()</code></a>
</p>
</li></ul>



<details open><summary>Inherited methods</summary>
<ul>
<li><span class="pkg-link" data-pkg="RnmrQuant1D" data-topic="internalClass" data-id="get_Matrix_Stats"><a href='../../RnmrQuant1D/html/internalClass.html#method-internalClass-get_Matrix_Stats'><code>RnmrQuant1D::internalClass$get_Matrix_Stats()</code></a></span></li>
</ul>
</details>

<hr>
<a id="method-RnmrQuant1D-new"></a>



<h4>Method <code>new()</code></h4>

<p>Class Constructor - Initializes internal parameters for preprocessing and deconvolution.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$new()</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>self</code></dt><dd><p>the RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>a RnmrQuant1D instance
</p>


<hr>
<a id="method-RnmrQuant1D-check_samples"></a>



<h4>Method <code>check_samples()</code></h4>

<p>Checks if the sample table format is right and if sample names correspond to spectra under the RAWDIR directory
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$check_samples(verbose = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>verbose</code></dt><dd><p>Display the success message if TRUE</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>nothing
</p>


<hr>
<a id="method-RnmrQuant1D-check_calibration"></a>



<h4>Method <code>check_calibration()</code></h4>

<p>Checks if the calibration profile is OK
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$check_calibration(
  QC = NULL,
  QS = NULL,
  sequence = NULL,
  verbose = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>QC</code></dt><dd><p>If specified, this is the name of the spectra directory for quality control (QC) (default is NULL)</p>
</dd>
<dt><code>QS</code></dt><dd><p>If specified, this is the name of the spectra directory for qualification standards (QS) (default is NULL)</p>
</dd>
<dt><code>sequence</code></dt><dd><p>If specified, this is the chosen sequence for testing. By default (NULL), the sequence in the RnmrQuant1D instance will be chosen.</p>
</dd>
<dt><code>verbose</code></dt><dd><p>Display the success message if TRUE</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>nothing
</p>


<hr>
<a id="method-RnmrQuant1D-check_profile"></a>



<h4>Method <code>check_profile()</code></h4>

<p>Checks if the quantification profile is OK
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$check_profile(verbose = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>verbose</code></dt><dd><p>Display the success message if TRUE</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>nothing
</p>


<hr>
<a id="method-RnmrQuant1D-check_outdir"></a>



<h4>Method <code>check_outdir()</code></h4>

<p>Checks if output directories (TMPDIR &amp; RDATADIR) are OK
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$check_outdir(verbose = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>verbose</code></dt><dd><p>Display the success message if TRUE</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>nothing
</p>


<hr>
<a id="method-RnmrQuant1D-check_all"></a>



<h4>Method <code>check_all()</code></h4>

<p>Checks many things : directories, profiles (quantification &amp; calibration), ...
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$check_all(verbose = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>verbose</code></dt><dd><p>Display the success message if TRUE</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>nothing
</p>


<hr>
<a id="method-RnmrQuant1D-get_samples_table"></a>



<h4>Method <code>get_samples_table()</code></h4>

<p>Generates the sample table for the corresponding sequence.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$get_samples_table(sequence = NULL, infos = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sequence</code></dt><dd><p>If specified, take samples defined for this NMR sequence. Otherwise, takes samples for the one defined in the instance.</p>
</dd>
<dt><code>infos</code></dt><dd><p>If TRUE, add some additional columns such as the TMSP width at half height and other acquisition parameters.</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>the sample table
</p>


<hr>
<a id="method-RnmrQuant1D-readProfile"></a>



<h4>Method <code>readProfile()</code></h4>

<p>Reads the quantification profile. See the <a href="https://github.com/djacob65/RnmrQuant1D/wiki/">wiki page</a> for having more details.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$readProfile(PROFILE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>PROFILE</code></dt><dd><p>the qualification profile filename</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>the qualification profile object
</p>


<hr>
<a id="method-RnmrQuant1D-get_response_factors"></a>



<h4>Method <code>get_response_factors()</code></h4>

<p>Calculates the response factors according to the sample type ('QC' or 'QS').
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$get_response_factors(
  sampletype,
  samplename,
  thresfP = 5,
  deconv = TRUE,
  verbose = 1
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sampletype</code></dt><dd><p>the sample type : 'QC' for Quality Control, or 'QS' for Quantification Standards.</p>
</dd>
<dt><code>samplename</code></dt><dd><p>a valid sample name under the spectra directory (QSDIR)</p>
</dd>
<dt><code>thresfP</code></dt><dd><p>defines the threshold of the CV (in percentage) of the response factor below which the spectrum (repetition) will not be taken into consideration.</p>
</dd>
<dt><code>deconv</code></dt><dd><p>defines whether the integration is calculated by deconvolution or by the Simpson approach.</p>
</dd>
<dt><code>verbose</code></dt><dd><p>if TRUE, some messages are displayed</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>a response factor object, i.e a list with some attributes: fPUL, fP, fR, MC, INTG, fK
</p>


<hr>
<a id="method-RnmrQuant1D-get_factor_table"></a>



<h4>Method <code>get_factor_table()</code></h4>

<p>Returns the factor table according to the sample type ('QC' or 'QS').
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$get_factor_table(QS)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>QS</code></dt><dd><p>a response factor object returned by <a href="#method-RnmrQuant1D-get_response_factors"><code>get_response_factors()</code></a>.</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>the factor table (matrix)
</p>


<hr>
<a id="method-RnmrQuant1D-get_QC_estimation"></a>



<h4>Method <code>get_QC_estimation()</code></h4>

<p>Estimation of the compound concentrations (QC) based on the PULCON factor (QS)
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$get_QC_estimation(QC, QS, merge = TRUE, verbose = 1)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>QC</code></dt><dd><p>a response factor object for a QC type returned by <a href="#method-RnmrQuant1D-get_response_factors"><code>get_response_factors()</code></a>.</p>
</dd>
<dt><code>QS</code></dt><dd><p>a response factor object for a QS type returned by <a href="#method-RnmrQuant1D-get_response_factors"><code>get_response_factors()</code></a>.</p>
</dd>
<dt><code>merge</code></dt><dd><p>If TRUE, merge compounds that have the same names but with a different number at end, e.g. &quot;citrate1&quot;, &quot;citrate2&quot; will be merged under &quot;citrate&quot;.</p>
</dd>
<dt><code>verbose</code></dt><dd><p>If TRUE, some messages are displayed</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>the estimation table (matrix)
</p>


<hr>
<a id="method-RnmrQuant1D-plot_QC_estimation"></a>



<h4>Method <code>plot_QC_estimation()</code></h4>

<p>Plots the estimation of the compound concentrations (QC) based on the PULCON factor (QS)
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$plot_QC_estimation(QCest)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>QCest</code></dt><dd><p>the estimation table returned by <a href="#method-RnmrQuant1D-get_QC_estimation"><code>get_QC_estimation()</code></a>.</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>a <a href="https://plotly.com/r/">plotly</a> graph
</p>


<hr>
<a id="method-RnmrQuant1D-proc_Integrals"></a>



<h4>Method <code>proc_Integrals()</code></h4>

<p>Performs the integration of all compounds defined by a pattern included in the specified zone(s).
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$proc_Integrals(zones, ncpu = 2, verbose = 1)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>zones</code></dt><dd><p>The selected zones for integration.</p>
</dd>
<dt><code>ncpu</code></dt><dd><p>The number of processors (cores) used for parallel computing.</p>
</dd>
<dt><code>verbose</code></dt><dd><p>if TRUE, some messages are displayed</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The result will be stored in the RnmrQuant1D instance.
</p>


<hr>
<a id="method-RnmrQuant1D-get_Matrix_Integrals"></a>



<h4>Method <code>get_Matrix_Integrals()</code></h4>

<p>Gets the integration matrix from the RnmrQuant1D instance, computed by <a href="#method-RnmrQuant1D-proc_Integrals"><code>proc_Integrals()</code></a>.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$get_Matrix_Integrals()</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>the integration matrix
</p>


<hr>
<a id="method-RnmrQuant1D-get_Matrix_SNR"></a>



<h4>Method <code>get_Matrix_SNR()</code></h4>

<p>Gets the SNR matrix from the RnmrQuant1D instance, computed by <a href="#method-RnmrQuant1D-proc_Integrals"><code>proc_Integrals()</code></a>.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$get_Matrix_SNR()</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>the SNR matrix
</p>


<hr>
<a id="method-RnmrQuant1D-get_Matrix_CV"></a>



<h4>Method <code>get_Matrix_CV()</code></h4>

<p>Gets the CV matrix from the integration matrix if samples have repetitions.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$get_Matrix_CV(MatInt = NULL, nbrep = 3)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>MatInt</code></dt><dd><p>The integration matrix. If NULL, it will be fetched from the the RnmrQuant1D instance. See <a href="#method-RnmrQuant1D-get_Matrix_Integrals"><code>get_Matrix_Integrals()</code></a>.</p>
</dd>
<dt><code>nbrep</code></dt><dd><p>the number of repetition. default=3.</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>the CV matrix
</p>


<hr>
<a id="method-RnmrQuant1D-save_Matrices"></a>



<h4>Method <code>save_Matrices()</code></h4>

<p>Saves the result tables (samples, integration, SNR) computed by <a href="#method-RnmrQuant1D-proc_Integrals"><code>proc_Integrals()</code></a> and other information for tracing (quantification profile, R environment, ...) into a workbook (<a href="https://docs.fileformat.com/spreadsheet/xlsx/">XLSX format</a>).
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$save_Matrices(file, filelist = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>file</code></dt><dd><p>the path to the output file</p>
</dd>
<dt><code>filelist</code></dt><dd><p>a simple list containing two elements, just for tracing : 1) SAMPLEFILE, the path to the sample file, 2) PROFILE, the path to the quantification profile.</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>nothing
</p>


<hr>
<a id="method-RnmrQuant1D-view_spectra"></a>



<h4>Method <code>view_spectra()</code></h4>

<p>Plots the ppm range defined by 'RnmrQuant1D$ppm_range', the latter being positioned by the zone(s) chosen when calculating the integrations by <a href="#method-RnmrQuant1D-proc_Integrals"><code>proc_Integrals()</code></a>.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$view_spectra(
  id,
  plotmodel = TRUE,
  plotTrueSpec = TRUE,
  plotzones = TRUE,
  tags = "none",
  legendhoriz = FALSE,
  verbose = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>id</code></dt><dd><p>the order number of the spectrum in the sample table.</p>
</dd>
<dt><code>plotmodel</code></dt><dd><p>If TRUE, plot the model based on the deconvolution.</p>
</dd>
<dt><code>plotTrueSpec</code></dt><dd><p>If TRUE, plot the original spectrum without local baseline corrections.</p>
</dd>
<dt><code>plotzones</code></dt><dd><p>If TRUE, add a semi-transparent rectangle superimposed on each fit zone.</p>
</dd>
<dt><code>tags</code></dt><dd><p>add an arrow annotation on each peak resulting from the deconvolution. Among the possible values: 1) 'id' adds the number of the compound to which the peak belongs, 2) 'name' adds the name of the compound to which the peak belongs, 'auto' adds either the number if multiple zones, or the name of the compound, 3) 'none' adds no arrow annotation.</p>
</dd>
<dt><code>legendhoriz</code></dt><dd><p>Put the legend at the bottom (TRUE) or at the left (FALSE) of the graph</p>
</dd>
<dt><code>verbose</code></dt><dd><p>If TRUE, The peak list is displayed</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>a <a href="https://plotly.com/r/">plotly</a> graph
</p>


<hr>
<a id="method-RnmrQuant1D-proc_fPULCON"></a>



<h4>Method <code>proc_fPULCON()</code></h4>

<p>Computes the response factor for the QS sample.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$proc_fPULCON(QSname, thresfP = 5, deconv = TRUE, verbose = 1)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>QSname</code></dt><dd><p>a valid QS sample name under the spectra directory (QSDIR)</p>
</dd>
<dt><code>thresfP</code></dt><dd><p>defines the threshold of the CV (in percentage) of the response factor below which the spectrum (repetition) will not be taken into consideration.</p>
</dd>
<dt><code>deconv</code></dt><dd><p>defines whether the integration is calculated by deconvolution or by the Simpson approach.</p>
</dd>
<dt><code>verbose</code></dt><dd><p>if TRUE, some messages are displayed</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>he resulting object (fP) will be stored in the RnmrQuant1D instance.
</p>


<hr>
<a id="method-RnmrQuant1D-proc_Quantification"></a>



<h4>Method <code>proc_Quantification()</code></h4>

<p>Computes for each sample the concentration  of targeted compounds  based on the quantification profile.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$proc_Quantification(
  cmpdlist = NULL,
  zones = NULL,
  ncpu = 2,
  reset = FALSE,
  CR = FALSE,
  verbose = 1
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>cmpdlist</code></dt><dd><p>Sets the list of targeted compounds. It can be null and in this case, it will be the list of zones that will be taken into consideration.</p>
</dd>
<dt><code>zones</code></dt><dd><p>In case the list of targeted compounds is null, then the targeted compounds will be defined by the patterns included in the indicated zones. If the list of zones is null, as well as that of the targeted compounds (cmpdlist), then takes into consideration all the zones defined in the quantification profile.</p>
</dd>
<dt><code>ncpu</code></dt><dd><p>The number of processors (cores) used for parallel computing.</p>
</dd>
<dt><code>reset</code></dt><dd><p>Indicates whether to delete all existing RData files or to proceed by accumulation. In this latter case, if some samples had already been processed then they will not be processed again.</p>
</dd>
<dt><code>CR</code></dt><dd><p>Indicates whether to add a Carriage Return for a more presentable display (case with Jupyter notebooks)</p>
</dd>
<dt><code>verbose</code></dt><dd><p>if TRUE, some messages are displayed</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The results will be stored under the <code>"RDATADIR"</code> directory as RData files.
</p>


<hr>
<a id="method-RnmrQuant1D-get_output_results"></a>



<h4>Method <code>get_output_results()</code></h4>

<p>Retrieves from RData files on disk generated by <a href="#method-RnmrQuant1D-proc_Quantification"><code>proc_Quantification()</code></a>, the result tables within a list.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$get_output_results()</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>the result tables within a list
</p>


<hr>
<a id="method-RnmrQuant1D-get_spectra_data"></a>



<h4>Method <code>get_spectra_data()</code></h4>

<p>Retrieves from RData files generated on disk by <a href="#method-RnmrQuant1D-proc_Quantification"><code>proc_Quantification()</code></a>, the spectra and the peaklist within lists in the RnmrQuant1D instance respectively named specList and res.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$get_spectra_data()</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>nothing
</p>


<hr>
<a id="method-RnmrQuant1D-save_Results"></a>



<h4>Method <code>save_Results()</code></h4>

<p>Saves the result tables (samples, integration, SNR, quantifications) computed by <a href="#method-RnmrQuant1D-proc_Quantification"><code>proc_Quantification()</code></a> and other information for tracing (calibration profile, quantification profile, R environment, ...) into a workbook (<a href="https://docs.fileformat.com/spreadsheet/xlsx/">XLSX format</a>).
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$save_Results(file, filelist = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>file</code></dt><dd><p>the path to the output file</p>
</dd>
<dt><code>filelist</code></dt><dd><p>a simple list containing three elements, just for tracing : 1) SAMPLEFILE, the path to the sample file, 2) PROFILE, the path to the quantification profile, 3) CALIBRATION, the path to the calibration profile</p>
</dd>
<dt><code>self</code></dt><dd><p>The RnmrQuant1D instance</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>nothing
</p>


<hr>
<a id="method-RnmrQuant1D-plot_spectra"></a>



<h4>Method <code>plot_spectra()</code></h4>

<p>Visualizes the compound 'compound' for spectrum 'id', where id is the order number of the spectrum in the sample table.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$plot_spectra(id, compound, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>id</code></dt><dd><p>The order number of the spectrum in the sample table</p>
</dd>
<dt><code>compound</code></dt><dd><p>The compound name taken from quantpars$cmpdlist in the RnmrQuant1D instance.</p>
</dd>
<dt><code>...</code></dt><dd><p>Arguments to be passed to the <a href="#method-RnmrQuant1D-view_spectra"><code>view_spectra()</code></a> method.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>a <a href="https://plotly.com/r/">plotly</a> graph
</p>


<hr>
<a id="method-RnmrQuant1D-displayWidget"></a>



<h4>Method <code>displayWidget()</code></h4>

<p>Displays a widget (e.g. a plotly graph) - Depending on the OutType attribute in the RnmrQuant1D instance, returns a <a href="https://plotly.com/r/">plotly</a> graph (html) or displays the image (png,svg, ...)
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$displayWidget(widget, tmpdir = "tmp", width = "auto", height = 400)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>widget</code></dt><dd><p>a plotly graph</p>
</dd>
<dt><code>tmpdir</code></dt><dd><p>the directory to temporarily save the image before displaying it (png,svg, ...)</p>
</dd>
<dt><code>width</code></dt><dd><p>the width of the output image</p>
</dd>
<dt><code>height</code></dt><dd><p>the height of the output image</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>depending on the OutType attribute in the RnmrQuant1D instance, returns a <a href="https://plotly.com/r/">plotly</a> graph (html) or display the image (png,svg, ...)
</p>


<hr>
<a id="method-RnmrQuant1D-saveWidgetFix"></a>



<h4>Method <code>saveWidgetFix()</code></h4>

<p>Saves a widget (e.g. a plotly graph) into a file - A wrapper to saveWidget which compensates for arguable BUG in htmlwidgets::saveWidget which requires 'file' to be in current working directory.
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$saveWidgetFix(widget, file, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>widget</code></dt><dd><p>a plotly graph</p>
</dd>
<dt><code>file</code></dt><dd><p>the path of the output filename</p>
</dd>
<dt><code>...</code></dt><dd><p>Arguments to be passed to htmlwidgets::saveWidget</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>nothing
</p>


<hr>
<a id="method-RnmrQuant1D-displayTable"></a>



<h4>Method <code>displayTable()</code></h4>

<p>Beautifies a matrix using the DT package before displaying it
</p>


<h5>Usage</h5>

<div class="r"><pre>RnmrQuant1D$displayTable(M, nbdec = 2, tmpdir = "tmp")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>M</code></dt><dd><p>the matrix to be embellished with the DT package</p>
</dd>
<dt><code>nbdec</code></dt><dd><p>the number of decimal places for floating point numbers in the output table</p>
</dd>
<dt><code>tmpdir</code></dt><dd><p>the directory to temporarily save the image before displaying it</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>Depending on the OutType attribute in the RnmrQuant1D instance, returns a <a href="https://plotly.com/r/">plotly</a> graph (html) or displays the image (png,svg, ...)
</p>




<h3>Author(s)</h3>

<p>Daniel Jacob - (C) INRAE 2025
</p>


<h3>References</h3>

<p>Guillaume Leleu et al. (2024) Development of a standardized method for metabolite analysis by NMR to assess wine authenticity, IVES Conference Series, OIV, DOI:10.58233/IMGGSIME
</p>
<p>Teipel et al. (2020) Application of 1H Nuclear Magnetic Resonance Spectroscopy as Spirit Drinks Screener for Quality and Authenticity Control, Food 9, 1355; doi:10.3390/foods9101355
</p>


</div>
</body></html>
